<Page
    x:Class="LibreSpotUWP.Views.Win10_1507.HomePage_Win10_1507"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:LibreSpotUWP.Controls"
    xmlns:converters="using:LibreSpotUWP.Converters"
    xmlns:selectors="using:LibreSpotUWP.Selectors"
    xmlns:spotify="using:SpotifyAPI.Web"
    xmlns:viewmodels="using:LibreSpotUWP.ViewModels"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Page.Resources>
        <DataTemplate x:Key="PlaylistTemplate" x:DataType="spotify:FullPlaylist">
            <StackPanel Width="140" Margin="0,0,12,12">
                <Image
                    Width="140"
                    Height="140"
                    Source="{x:Bind Images[0].Url}" />
                <TextBlock Text="{x:Bind Name}" TextTrimming="CharacterEllipsis" />
            </StackPanel>
        </DataTemplate>

        <DataTemplate x:Key="SavedAlbumTemplate" x:DataType="spotify:SavedAlbum">
            <StackPanel Width="140" Margin="0,0,12,12">
                <Image
                    Width="140"
                    Height="140"
                    Source="{x:Bind Album.Images[0].Url}" />
                <TextBlock Text="{x:Bind Album.Name}" TextTrimming="CharacterEllipsis" />
            </StackPanel>
        </DataTemplate>

        <DataTemplate x:Key="AlbumTemplate" x:DataType="spotify:FullAlbum">
            <StackPanel Width="140" Margin="0,0,12,12">
                <Image
                    Width="140"
                    Height="140"
                    Source="{x:Bind Images[0].Url}" />
                <TextBlock Text="{x:Bind Name}" TextTrimming="CharacterEllipsis" />
            </StackPanel>
        </DataTemplate>

        <DataTemplate x:Key="ArtistTemplate" x:DataType="spotify:FullArtist">
            <StackPanel Width="140" Margin="0,0,12,12">
                <Ellipse Width="140" Height="140">
                    <Ellipse.Fill>
                        <ImageBrush ImageSource="{x:Bind Images[0].Url}" />
                    </Ellipse.Fill>
                </Ellipse>
                <TextBlock Text="{x:Bind Name}" TextTrimming="CharacterEllipsis" />
            </StackPanel>
        </DataTemplate>

        <DataTemplate x:Key="TrackTemplate" x:DataType="spotify:FullTrack">
            <StackPanel Width="140" Margin="0,0,12,12">
                <Image
                    Width="140"
                    Height="140"
                    Source="{x:Bind Album.Images[0].Url}" />
                <TextBlock Text="{x:Bind Name}" TextTrimming="CharacterEllipsis" />
                <TextBlock
                    FontSize="12"
                    Foreground="Gray"
                    Text="{x:Bind Artists[0].Name}" />
            </StackPanel>
        </DataTemplate>

        <selectors:HomeItemTemplateSelector
            x:Key="HomeSelector"
            AlbumTemplate="{StaticResource AlbumTemplate}"
            ArtistTemplate="{StaticResource ArtistTemplate}"
            PlaylistTemplate="{StaticResource PlaylistTemplate}"
            SavedAlbumTemplate="{StaticResource SavedAlbumTemplate}"
            TrackTemplate="{StaticResource TrackTemplate}" />

        <CollectionViewSource
            x:Name="HomeGroupedSource"
            IsSourceGrouped="True"
            ItemsPath="Items"
            Source="{x:Bind ViewModel.GroupedHomeContent, Mode=OneWay}" />
    </Page.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <SemanticZoom Grid.Row="0">
            <SemanticZoom.ZoomedInView>
                <GridView
                    Padding="16"
                    ItemTemplateSelector="{StaticResource HomeSelector}"
                    ItemsSource="{x:Bind HomeGroupedSource.View, Mode=OneWay}"
                    SelectionMode="None">
                    <GridView.GroupStyle>
                        <GroupStyle>
                            <GroupStyle.HeaderTemplate>
                                <DataTemplate x:DataType="viewmodels:HomeSectionGroup">
                                    <TextBlock
                                        Margin="0,10"
                                        FontSize="22"
                                        FontWeight="Bold"
                                        Text="{x:Bind Title}" />
                                </DataTemplate>
                            </GroupStyle.HeaderTemplate>
                        </GroupStyle>
                    </GridView.GroupStyle>
                </GridView>
            </SemanticZoom.ZoomedInView>

            <SemanticZoom.ZoomedOutView>
                <ListView ItemsSource="{x:Bind HomeGroupedSource.View.CollectionGroups, Mode=OneWay}" SelectionMode="None">
                    <ListView.ItemTemplate>
                        <DataTemplate x:DataType="ICollectionViewGroup">
                            <TextBlock
                                Margin="10"
                                FontSize="24"
                                Text="{x:Bind Group.(viewmodels:HomeSectionGroup.Title)}" />
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </SemanticZoom.ZoomedOutView>
        </SemanticZoom>

        <controls:NarrowMediaControllerBar Grid.Row="1" />
    </Grid>
</Page>